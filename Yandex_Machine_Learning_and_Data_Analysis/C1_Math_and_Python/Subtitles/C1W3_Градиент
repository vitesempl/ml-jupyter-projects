[БЕЗ_ЗВУКА] В этом видео мы узнаем, что такое частные производные и градиент. Мы уже познакомились с понятием производной для функции одной переменной. И мы уже знаем геометрический смысл производной для функции одной переменной. Это просто угловой коэффициент касательной. Однако в жизни чаще встречаются функции многих переменных. Но как ввести производную хотя бы для функции двух переменных? Самая простая мысль — это зафиксировать какое-то значение одной переменной и продифференцировать по другой. Ну, например, зафиксируем y, продифференцируем по x, получим производную f'x. Зафиксируем x, продифференцируем по y и получим производную f'y. Такие производные называются частными производными, и, наверное, интересно разобраться, каков их геометрический смысл. Если в случае функции одной переменной мы приближали график функции касательной, то в случае функции двух переменных, мы приближаем график целой касательной плоскостью. Но при этом можно посмотреть на картинку практически в одномерном виде, опять же зафиксировав отдельные координаты. Ну то есть в проекции на плоскость zx мы снова увидим, что производная по x — это угловой коэффициент касательной. В проекции на плоскость zy опять же увидим, что производная по y — это тоже угловой коэффициент касательной. Но интересно посмотреть на то, как это все будет выглядеть в пространстве. Мы приближаем касательной плоскостью график функции от x и y. Давайте считать, что при переходе от точки (x0, y0) к точке (x, y) у нас сначала x поменялся на дельта x, а затем y поменялся на дельта y. Изменения координаты z вдоль касательной плоскости при изменении x на дельта x будет равно f'x умножить на дельта x. Изменение координаты z при изменении y на дельта y будет равно f'y умножить на дельта y. А сумма этих изменений даст итоговое изменение координаты z, которым мы и приближаем изменение функции дельта f. Но все это какие-то отдельные величины, мы можем посчитать частные производные по каждой переменной, но хочется, наверное, какой-то единый объект. Его совершенно несложно придумать, достаточно просто построить вектор из частных производных функции. Такой вектор называется градиентом, и он обладает различными интересными свойствами. Например, он задает направление наискорейшего роста функции. Об этом мы поговорим позднее. Также вы можете встречаться с другими иллюстрациями к понятию градиента, поэтому полезно познакомиться с еще одним способом визуализировать функции о двух переменных, а именно с линиями уровня. Линии уровня — это линии, вдоль которых функция принимает какое-то фиксированное значение. Таким образом, можно просто изображать эти линии на плоскости и получать какое-то представление о том, как меняется функция в разных точках. Вот если изобразить градиент вместе с линиями уровня, то градиент будет перпендикулярен линиям уровня. Это станет более понятно, когда мы разберемся с тем, как связано направление градиента с изменением значения функции. В общем случае, когда мы работаем с функцией n переменных, мы можем считать, что функция просто зависит от вектора x из пространства Rn, то есть состоящего из координат x1, ..., xn. Давайте сразу оговорим обозначения. Мы можем обозначать функции многих переменных как f (x1, ..., xn), а можем обозначать как f(x), где x — это вектор. С другой стороны, в случае, когда у нас переменные две, мы можем обозначать функцию f(x1, x2) по аналогии с предыдущими обозначениями, но есть достаточно привычный способ обозначать f(x, y). Все эти обозначения достаточно часто встречаются, поэтому мы будем использовать именно их. Как вы видите, x может быть как вектором, так и скаляром. В дальнейшем это будет понятно из контекста. Подведем итог. Мы познакомились с понятием частных производных и с понятием градиента. Оба эти понятия очень важны и будут использоваться как в этом курсе, так и во всей специализации в дальнейшем.

[БЕЗ_ЗВУКА] Итак, мы с вами уже знаем, что такое частные производные и градиент. Пора узнать, зачем же они нужны. Представим, что мы решаем некоторую задачу оптимизации. Ну, например, у нас есть функция от многих переменных, x1, ..., xn, и мы хотим её минимизировать. Ну откуда может взяться такая задача? Например, мы можем выбирать оптимальные параметры рекламной кампании или подбирать веса классификатора текстов, минимизируя ошибку классификации, или настраивать параметры сложного технологического процесса, минимизируя вероятность неудачи. Но как же нам выбрать параметры таким образом, чтобы функция была минимальной? Ну давайте посмотрим на ситуацию в простом двумерном случае, то есть в случае функции от двух переменных x и y. Если зафиксировать значение x и посмотреть на всё в координатах z и y, и если зафиксировать значение y и посмотреть на всё в координатах z и x, из графиков станет понятно, что значения частных производных в точке экстремума должны быть нулевыми. Так как все частные производные должны равняться 0, можно просто сказать, что градиент должен быть нулевым вектором. Но бывают ситуации, когда функция не выписывается аналитически или когда полученные уравнения слишком сложны. Что же делать в этом случае? В этом случае вам поможет численная оптимизация. Так как градиент — это направление наискорейшего роста, а антиградиент — это направление наискорейшего убывания, то давайте просто начнём в произвольной точке (x1, ..., xN), и на каждом шаге будем двигаться в сторону антиградиента. Таким образом, значение x n+1 (нашего аргумента функции, векторного аргумента) будет получаться из прошлого значения xn просто вычитанием антиградиента, умноженного на некоторую величину, называемую шагом градиентного спуска. Таким образом, мы будем постепенно приближаться к минимуму и в идеальной картине мира, конечно, его достигнем. У этого всего есть простая аналогия. Представьте, что вы приехали в незнакомое место и поселились где-то в низине. Гуляя по недалёким окрестностям, вы заблудились и теперь хотите попасть домой. Понятно, что если вы не ориентируетесь в местности, самым логичным решением будет идти по самому крутому уклону вниз. Таким образом вы, конечно, настигните место, где поселились. Конечно, есть вопрос, насколько это будет безопасно, но, кстати, если говорить о безопасности, то задача экстремума с дополнительными условиями — это задача условного экстремума, и об этом будет рассказано в дополнительной лекции. Итак. Подведём итог. Мы познакомились с вами с необходимым условием минимума функции многих переменных, а также узнали, как работает градиентный спуск, Отличный алгоритм численной оптимизации, который будет использоваться в нашей специализации повсеместно.

[БЕЗ_ЗВУКА] В этом видео вы узнаете, что такое производная по направлению. Мы с вами уже знаем, что такое частные производные и градиент. Теперь мы узнаем еще один вид производных. Давайте представим, что мы хотим узнать, как меняется функция в определенной точке x в направлении l. l — это некоторый вектор. Для этого можно посмотреть на значение функции в точке x + t * l, и сравнить его со значением функции в точке x. Если мы будем смотреть на отношение разности этих значений к параметру t и будем устремлять параметр t к 0, то всё это выражение будет стремиться к некоторому числу, которое и называется производной по направлению l. Так как нас интересует только направление вектора l, мы можем считать, что мы ограничились векторами, норма которых равна 1. Производная по направлению имеет наглядный геометрический смысл, который проще всего пояснить в двумерном случае, в случае, когда мы рассматриваем функцию о двух переменных x и y. Представьте себе поверхность, которая является графиком функции f(x, y), которая рассекается плоскостью, проходящей через точку x0, y0 вдоль вектора l, и перпендикулярна плоскости x, y. Таким образом, она дает нам этот график в сечении. Если мы посмотрим на это сечение, то увидим, что ситуация свелась к более привычной нам одномерной ситуации. То есть теперь мы можем рассматривать нашу функцию как функцию от параметра t. Теперь понятно, что наша производная по направлению — это просто производная новой функции от параметра t в точке t = 0. И понятен смысл производной по направлению. Это просто скорость роста функции в заданном вектором l направлении. Итак, подведем итог. Производная по направлению — это скорость роста функции в направлении l. Это понятие понадобится нам, чтобы лучше понять геометрический смысл градиента. Так как мы с вами уже знаем, что градиент задает направление наискорейшего роста функции.

[БЕЗ ЗВУКА] В этом видео вы узнаете, что такое касательная плоскость и линейное приближение. Давайте рассмотрим изменение значения функции f(x, y) при переходе от точки (x0, y0) к точке (x0 + Δx, y0 + Δy). Как мы знаем, мы можем оценить изменение значения функции с помощью несложной формулы, используя частные производные. Для этого достаточно взять частную производную функции по x и умножить ее на Δx, взять частную производную по y и умножить ее на Δy и сложить. Эту формулу можно записать компактней, используя скалярное произведение градиента на вектор изменения значений координат. На самом деле, эта приближенная формула имеет смысл приближения графика нашей функции касательной плоскостью. Даже если мы посмотрим на уравнение этой касательной плоскости, мы увидим в точности нашу приближенную формулу. Обратите внимание, чем ближе мы к точке (x0, y0), тем более точно выполняется наше приближенное равенство. Так как это выражения для Δf линейно по Δx = x − x0 и Δy = y − y0, оценка значений функции с помощью этого выражения называется линейным приближением. Линейное приближение часто используется для анализа сложных функций, в частности при построении алгоритмов анализа данных. Подведем итог. Мы вспомнили с вами связь частных производных с приростом значения функции, выяснили, что такое касательная плоскость и как она приближает график функции многих переменных, и познакомились с линейным приближением функции многих переменных.

[БЕЗ ЗВУКА] Теперь мы готовы к тому, чтобы разобраться, почему же градиент задает направление наискорейшего роста функции. Итак, мы уже достаточно подробно изучили выражение для приближенной оценки прироста функции при небольших изменениях ее аргументов. Также мы разобрались с тем, что такое производная по направлению. Давайте для простоты будем рассматривать двумерный случай, но на самом деле для n-мерного все выкладки будут абсолютно те же. Давайте обозначим изменение значения функции Δf, и в наших прошлых обозначениях Δx теперь будет t * lx, а Δy — t * ly, то есть наши сдвиги по x и по y. Если мы распишем Δf по приближенной формуле, то мы увидим, что получается t умножить на скалярное произведение градиента, на вектор l. Обратите внимание, при стремлении t к 0 Δx и Δy тоже стремятся к 0. Ну то есть мы все ближе подбираемся к точке (x0, y0). А как вы помните, чем ближе мы к точке (x0, y0), тем точнее работает наша приближенная формула. Именно поэтому мы можем воспользоваться ей под знаком предела. Таким образом, мы видим, что Δf / t при t стремящемся к 0 будет стремиться к скалярному произведению градиента на вектор l. И это есть производная по направлению в точке (x0, y0). Теперь самое время разобраться, при чем же здесь направление наискорейшего роста. Ну давайте просто задумаемся, когда производная по направлению будет максимальной, при каком направлении. Скалярное произведение — вещь достаточно простая. Это просто произведение норм векторов на косинус угла между ними. На нормы вектора l мы влиять не можем, потому что мы им задаем просто направление. Мы можем считать, что его норма просто равна 1. На градиент мы тоже влиять не можем. А вот косинус θ мы можем менять, выбирая разные направления. И косинус будет максимален тогда, когда равен 1, то есть когда угол θ между градиентом и вектором l равен 0, то есть вектор l направлен туда же, куда и градиент. Таким образом, градиент действительно задает направление наискорейшего роста. И для того, чтобы выяснить это, нам понадобилось связать производную по направлению l с градиентом.