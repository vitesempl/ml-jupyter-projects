[БЕЗ_ЗВУКА] Привет! Вот вы и добрались до конца первого курса нашей специализации. Поздравляю, отличная работа. Теперь у вас есть необходимый фундамент для изучения сложных и интересных методов анализа данных. В качестве бонуса мы решили записать для вас это видео. В нем я покажу вам некоторые методы из тех, что мы будем изучать в следующем курсе — обучение на размеченных данных. Данные, которые я хочу сейчас проанализировать вместе с вами, взяты из статьи 2009 года. В ней собраны оценки почти 6500 португальских вин Vinho Verde, выставленных дегустаторами при слепом тестировании в баллах по шкале от 0 до 10. Вот так выглядит распределение экспертных оценок в нашей выборке. Как вы видите, большая часть вин получает оценку в 6 баллов. Есть несколько вин, получающих 9 баллов, и немного вин — 3 балла. Давайте научимся предсказывать этот признак, чтобы мы могли заранее предположить, какую оценку получит вино, которого нет в нашей выборке. Чтобы полноценно смоделировать эту ситуацию, давайте отделим 25 % данных и оставим их для контроля качества предсказания, а обучаться будем на оставшихся 75 %. Если у нас больше нет никакой информации, то наше лучшее предположение об оценке — это среднее всех имеющихся в обучающей выборке, то есть в данном случае 5,8 балла. Если мы этой величиной будем предсказывать оценку всех вин, то на обучающей выборке мы получим среднеквадратичную ошибку 0,87 баллов, а на тестовой — 0,89. На тестовой выборке ошибка больше, поскольку среднее мы оценивали по обучающей. Это естественный эффект. На самом деле у нас есть еще какая-то информация, например о типе вина. В нашей выборке примерно 1600 красных вин и 4900 белых. Причем, если мы посмотрим на экспертные оценки отдельно по этим категориям, мы увидим, что они существенно отличаются. Так, большая часть белых вин получает оценку в 6 баллов, а большая часть красных — в 5. Нет ни одного красного вина, которое получает оценку 9 баллов. Различие между средними оценками по типам вина статистически значимо, критерий Стьюдента это подтверждает. Чтобы уточнить наши предсказания, мы можем оценку каждого вина предсказывать средним по оценкам вин такого же типа в нашей обучающей выборке. Если мы будем так делать, ошибки предсказания немного уменьшатся, а ошибка на обучающей выборке будет составлять 0,86, а на тестовой — 0,88. Вот так выглядят истинные оценки вин и их предсказания на тестовой выборке. На самом деле у нас есть еще 11 признаков, которые описывают химический состав вин. Их можно тоже как-то использовать для предсказания. Давайте посмотрим на графики, на которых по горизонтальной оси отложено качество вина, а по вертикальной — каждый признак. Каждая точка на этом графике — это один образец: белые точки — это белые вина, красные точки — красные вина. Как можно заметить, некоторые из признаков очень хорошо коррелированы с качеством вина. То есть есть шанс, что их можно использовать для улучшения предсказания. Построим для начала обычную линейную регрессию. Как видно, ошибка предсказания существенно уменьшается. На тестовой выборке она теперь составляет 0,74, на обучающей — 0,73. Вот так выглядят истинные оценки качества вина по сравнению с их предсказаниями линейной регрессии. На левом графике — для обучающей выборке, на правом — для тестовой. Каждая точка здесь — это одно вино. Как мы видим, облако точек начинает постепенно вытягиваться вдоль диагонали этого графика, то есть мы начинаем предсказывать качество вина более или менее точно. Давайте посчитаем коэффициент детерминации. Это доля объясненной моделью дисперсии нашего отклика, то есть качества вина. В данном случае он составляет 0,31, то есть 31 % дисперсии отклика нам удалось объяснить с помощью линейной регрессии. Давайте теперь возьмем более сложную модель. Построим на обучающей выборке случайный лес. Как видно, качество вырастает еще сильнее, хотя модель и переобучена, потому что ошибка на тестовой выборке значительно больше, чем на обучающей. На обучающей — 0,25, на тестовой — 0,42. Тем не менее и та и другая ошибка существенно меньше, чем для линейной регрессии. Давайте сравним истинные оценки качества вин с их предсказаниями, полученными случайным лесом. Мы видим, что облако точек еще сильнее вытянулось вокруг диагонали, то есть качество выросло, и это видно невооруженным взглядом. Коэффициент детерминации для случайного леса составляет 0,78, то есть с помощью этой новой модели нам удается объяснить уже 78 % дисперсии нашего признака — качества вина. Давайте сравним ошибки линейной регрессии и случайного леса. На следующей гистограмме отложены попарные разности абсолютных ошибок оценок качества линейной модели и случайного леса. Как вы видите, это распределение имеет пик в районе нуля. Но у него достаточно тяжелый правый хвост. Таким образом, понятно, что линейная модель чаще сильно ошибается, чем модель случайного леса. Критерий Стьюдента говорит, что различия между абсолютными ошибками значимы. Давайте под конец посмотрим, какие признаки лучше всего помогают предсказывать экспертную оценку. Посчитаем важность вклада каждого признака в модель случайного леса и посмотрим в следующую таблицу. Здесь мы видим, что сильнее всего на экспертную оценку качества вина влияет содержание алкоголя. Забавный факт. Надеюсь, вам понравился этот небольшой пример. В следующем курсе мы подробно разберем все эти методы и многие другие. Оставайтесь с нами!